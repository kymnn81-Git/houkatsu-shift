<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚·ãƒ•ãƒˆå¸Œæœ›ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
<style>
:root {
  --color-best: #d4edda;
  --color-good: #fff3cd;
  --color-bad: #f8d7da;
  --color-weekend: #e8e8e8;
  --color-assigned: #fff3cd;
  --border-color: #ccc;
}

* {
  box-sizing: border-box;
}

body {
  font-family: 'Hiragino Sans', 'Meiryo', sans-serif;
  margin: 0;
  padding: 10px;
  background: #fafafa;
  font-size: 14px;
}

.no-print {
  display: block;
}

h1 {
  font-size: 1.5rem;
  margin: 0 0 10px;
}

.controls {
  margin-bottom: 15px;
  padding: 10px;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.controls button {
  margin: 3px;
  padding: 8px 12px;
  font-size: 13px;
  cursor: pointer;
  border: 1px solid #007bff;
  background: #007bff;
  color: white;
  border-radius: 3px;
}

.controls button:hover {
  background: #0056b3;
}

.controls button.secondary {
  background: #6c757d;
  border-color: #6c757d;
}

.controls button.secondary:hover {
  background: #545b62;
}

.controls button.danger {
  background: #dc3545;
  border-color: #dc3545;
}

.controls button.danger:hover {
  background: #c82333;
}

.month-nav {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
  flex-wrap: wrap;
}

.month-nav h2 {
  margin: 0;
  font-size: 1.3rem;
}

.member-mgmt {
  margin: 10px 0;
}

.member-input-group {
  display: flex;
  gap: 5px;
  margin-bottom: 10px;
  flex-wrap: wrap;
}

.member-input-group input[type="text"] {
  padding: 8px;
  border: 1px solid #ddd;
  border-radius: 3px;
  font-size: 13px;
  flex: 1;
  min-width: 150px;
}

.member-input-group input[type="date"] {
  padding: 8px;
  border: 1px solid #ddd;
  border-radius: 3px;
  font-size: 13px;
}

.member-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  margin-top: 5px;
}

.member-item {
  display: flex;
  align-items: center;
  background: #e9ecef;
  padding: 5px 8px;
  border-radius: 3px;
  font-size: 12px;
}

.member-item button {
  margin-left: 5px;
  padding: 2px 6px;
  font-size: 11px;
  cursor: pointer;
  border: none;
  background: #dc3545;
  color: white;
  border-radius: 2px;
  transition: background 0.2s;
}

.member-item button:hover {
  background: #c82333;
  transform: scale(1.1);
}

.totals-display {
  margin: 10px 0;
  padding: 10px;
  background: #f8f9fa;
  border-radius: 4px;
  font-size: 12px;
}

.count-table {
  width: 100%;
  border-collapse: collapse;
  background: white;
  font-size: 13px;
}

.count-table th,
.count-table td {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: center;
}

.count-table th {
  background: #007bff;
  color: white;
  font-weight: bold;
  padding: 10px 8px;
}

.count-table thead tr:first-child th {
  background: #007bff;
}

.count-table thead tr:last-child th:nth-child(1),
.count-table thead tr:last-child th:nth-child(2),
.count-table thead tr:last-child th:nth-child(3) {
  background: #42a5f5;
}

.count-table thead tr:last-child th:nth-child(4),
.count-table thead tr:last-child th:nth-child(5),
.count-table thead tr:last-child th:nth-child(6) {
  background: #1976d2;
}

.count-table tbody tr:nth-child(even) {
  background: #f8f9fa;
}

.count-table tbody tr:hover {
  background: #e9ecef;
}

.totals-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 8px;
}

.total-item {
  padding: 5px;
  background: white;
  border-radius: 3px;
  border: 1px solid #dee2e6;
}

.total-item strong {
  color: #007bff;
}

.sync-status {
  position: fixed;
  top: 10px;
  right: 10px;
  padding: 5px 10px;
  background: #28a745;
  color: white;
  border-radius: 3px;
  font-size: 12px;
  z-index: 1000;
}

.sync-status.syncing {
  background: #ffc107;
}

.sync-status.error {
  background: #dc3545;
}

.calendar-container {
  overflow-x: auto;
  overflow-y: auto;
  margin: 15px 0;
  max-height: 70vh;
  position: relative;
  border: 1px solid var(--border-color);
}

.calendar {
  border-collapse: collapse;
  width: 100%;
  min-width: 700px;
  background: white;
  font-size: 13px;
}

.calendar th, .calendar td {
  border: 1px solid var(--border-color);
  padding: 4px;
  text-align: center;
  vertical-align: middle;
  min-width: 60px;
}

.calendar thead th {
  position: sticky;
  top: 0;
  background: #007bff;
  color: white;
  z-index: 10;
  font-weight: bold;
}

/* æ—¥ä»˜åˆ—å›ºå®š */
.calendar td:first-child,
.calendar th:first-child {
  position: sticky;
  left: 0;
  background: white;
  z-index: 5;
  font-weight: bold;
  min-width: 35px;
  max-width: 35px;
  font-size: 11px;
}

.calendar thead th:first-child {
  z-index: 11;
  background: #007bff;
}

/* AM/PMåˆ—å›ºå®š */
.calendar tbody td:nth-child(2) {
  position: sticky;
  left: 35px;
  background: white;
  z-index: 5;
  font-weight: bold;
  min-width: 30px;
  max-width: 30px;
  font-size: 11px;
}

.calendar thead th:nth-child(2) {
  position: sticky;
  left: 35px;
  z-index: 11;
  background: #007bff;
  min-width: 30px;
  max-width: 30px;
}

/* æ‹…å½“è€…åˆ—å›ºå®š */
.calendar tbody td:nth-child(3) {
  position: sticky;
  left: 65px;
  background: white;
  z-index: 5;
  font-weight: bold;
  min-width: 70px;
  font-size: 16px;
}

.calendar thead th:nth-child(3) {
  position: sticky;
  left: 65px;
  z-index: 11;
  background: #007bff;
  min-width: 70px;
}

/* ä¼‘æ—¥è¡Œã®æ‹…å½“åˆ—ã‚‚ç¢ºå®Ÿã«ç™½ã«ã™ã‚‹ */
.calendar tbody td:nth-child(3).weekend-bg {
  background: #e8e8e8 !important;
}

/* æ‹…å½“ã‚»ãƒ«ã®selectè¦ç´  */
.assigned-cell {
  background: white;
}

.assigned-cell select {
  width: 100%;
  padding: 4px 2px;
  font-size: 14px;
  border: 1px solid #ddd;
  border-radius: 3px;
  background: white;
  font-weight: bold;
}

.weekend-bg {
  background-color: var(--color-weekend) !important;
}

.shift-cell {
  padding: 8px 4px;
  cursor: pointer;
  transition: all 0.1s;
  min-height: 35px;
  user-select: none;
  font-weight: normal !important;
}

.shift-cell:hover {
  transform: scale(1.05);
  box-shadow: 0 0 0 2px #007bff;
  z-index: 1;
}

.shift-cell:active {
  transform: scale(0.95);
}

.shift-cell.best {
  background-color: var(--color-best);
}

.shift-cell.good {
  background-color: var(--color-good);
}

.shift-cell.bad {
  background-color: var(--color-bad);
}

.shift-cell.weekend-bg.best {
  background-color: #c8e6c9 !important;
}

.shift-cell.weekend-bg.good {
  background-color: #fff9c4 !important;
}

.shift-cell.weekend-bg.bad {
  background-color: #ffcdd2 !important;
}

.assigned-cell select {
  width: 100%;
  padding: 4px 2px;
  font-size: 14px;
  border: 1px solid #ddd;
  border-radius: 3px;
  background: white;
  font-weight: bold;
}

.login-container {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.login-box {
  background: white;
  padding: 40px;
  border-radius: 10px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.2);
  width: 100%;
  max-width: 400px;
}

.login-box h1 {
  text-align: center;
  color: #333;
  margin-bottom: 30px;
}

.login-box input {
  width: 100%;
  padding: 12px;
  margin-bottom: 20px;
  border: 1px solid #ddd;
  border-radius: 5px;
  font-size: 14px;
}

.login-box button {
  width: 100%;
  padding: 12px;
  background: #007bff;
  color: white;
  border: none;
  border-radius: 5px;
  font-size: 16px;
  cursor: pointer;
}

.login-box button:hover {
  background: #0056b3;
}

.error-message {
  color: #dc3545;
  text-align: center;
  margin-top: 10px;
  font-size: 14px;
}

@media print {
  body {
    background: white;
    padding: 0;
  }

  .no-print {
    display: none !important;
  }

  .calendar-container {
    overflow: visible;
    max-height: none;
    border: none;
  }

  .calendar {
    font-size: 10px;
  }

  .calendar th, .calendar td {
    padding: 2px;
    min-width: auto;
  }

  .calendar th,
  .calendar td {
    position: static !important;
  }

  .sync-status {
    display: none;
  }
}

@media (max-width: 768px) {
  .calendar {
    font-size: 11px;
  }
  
  .calendar th, .calendar td {
    padding: 3px;
    min-width: 50px;
  }

  .controls button {
    font-size: 12px;
    padding: 6px 10px;
  }
}
</style>
</head>
<body>

<div id="loginScreen" class="login-container">
  <div class="login-box">
    <h1>ğŸ—“ï¸ ã‚·ãƒ•ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h1>
    <input type="password" id="passwordInput" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›" onkeypress="if(event.key==='Enter') login()">
    <button onclick="login()">ãƒ­ã‚°ã‚¤ãƒ³</button>
    <div id="loginError" class="error-message"></div>
  </div>
</div>

<div id="mainScreen" style="display: none;">
  <div class="no-print">
    <h1>ğŸ“‹ åŒ…æ‹¬åŒæ„ã‚·ãƒ•ãƒˆ</h1>
    
    <div id="syncStatus" class="sync-status">âœ“ åŒæœŸæ¸ˆã¿</div>

    <div class="controls">
      <div class="month-nav">
        <button onclick="changeMonth(-1)">â—€å‰æœˆ</button>
        <button onclick="changeMonth(0)">ä»Šæœˆ</button>
        <button onclick="changeMonth(1)">æ¬¡æœˆâ–¶</button>
        <h2 id="currentMonth"></h2>
        <button onclick="logout()" class="danger">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
      </div>

      <div style="margin-top: 10px;">
        <button onclick="autoAssign()">ğŸ¯ æœªå‰²å½“ã‚’è‡ªå‹•å‰²ã‚ŠæŒ¯ã‚Šï¼ˆä»Šæœˆï¼‰</button>
        <button onclick="window.print()" class="secondary">ğŸ–¨ï¸ å°åˆ·</button>
        <button onclick="resetData()" class="danger">ğŸ—‘ï¸ ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ</button>
      </div>
    </div>
  </div>

  <div class="calendar-container">
    <table class="calendar" id="calendar">
      <thead>
        <tr id="headerRow">
          <th>æ—¥ä»˜</th>
          <th>æ™‚é–“</th>
          <th>æ‹…å½“</th>
        </tr>
      </thead>
      <tbody id="calendarBody">
      </tbody>
    </table>
  </div>

  <div class="no-print" style="text-align: center; margin: 10px 0; color: #666; font-size: 12px;">
    ãƒ‡ãƒ¼ã‚¿ã¯Firebaseã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã•ã‚Œã¾ã™
  </div>

  <div class="no-print">
    <div class="totals-display">
      <strong>ğŸ“Š æœˆé–“ãƒ»ç´¯è¨ˆã‚«ã‚¦ãƒ³ãƒˆï¼š</strong>
      <div style="overflow-x: auto; margin-top: 10px;">
        <table id="countTable" class="count-table">
          <thead>
            <tr>
              <th rowspan="2">ãƒ¡ãƒ³ãƒãƒ¼</th>
              <th colspan="3">ä»Šæœˆ</th>
              <th colspan="3">ç´¯è¨ˆ</th>
            </tr>
            <tr>
              <th>AM</th>
              <th>PM</th>
              <th>åˆè¨ˆ</th>
              <th>AM</th>
              <th>PM</th>
              <th>åˆè¨ˆ</th>
            </tr>
          </thead>
          <tbody id="countTableBody"></tbody>
        </table>
      </div>
    </div>

    <div class="controls">
      <div class="member-mgmt">
        <strong>ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†ï¼š</strong>
        <div class="member-input-group">
          <input type="text" id="newMemberName" placeholder="æ–°ã—ã„ãƒ¡ãƒ³ãƒãƒ¼å" onkeypress="if(event.key==='Enter') addMember()">
          <button onclick="addMember()">ãƒ¡ãƒ³ãƒãƒ¼è¿½åŠ </button>
          <button onclick="showDeleteMemberDialog()" class="danger">ãƒ¡ãƒ³ãƒãƒ¼å‰Šé™¤</button>
        </div>
        <div id="memberList" class="member-list"></div>
      </div>

      <div class="member-mgmt">
        <strong>ä¼‘æ—¥ç®¡ç†ï¼š</strong>
        <div class="member-input-group">
          <input type="date" id="newHolidayDate">
          <button onclick="addCustomHoliday()">ä¼‘æ—¥è¿½åŠ </button>
        </div>
        <div id="holidayList" class="member-list"></div>
      </div>
    </div>
  </div>
</div>

<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import { getDatabase, ref, set, get, onValue } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

const firebaseConfig = {
  apiKey: "AIzaSyBpQF8Po_337C9a46dR1wXKDT3oE5TkQoI",
  authDomain: "gstatic-bdd55.firebaseapp.com",
  databaseURL: "https://gstatic-bdd55-default-rtdb.firebaseio.com",
  projectId: "gstatic-bdd55",
  storageBucket: "gstatic-bdd55.firebasestorage.app",
  messagingSenderId: "476687726358",
  appId: "1:476687726358:web:62fc82d485e8896d75df6d"
};

const app = initializeApp(firebaseConfig);
const database = getDatabase(app);
console.log('âœ… FirebaseåˆæœŸåŒ–å®Œäº†');

const auth = {
  PASSWORD: 'jfcr',
  SESSION_KEY: 'shift_authenticated'
};

window.login = function() {
  const password = document.getElementById('passwordInput').value;
  const errorDiv = document.getElementById('loginError');
  
  if (password === auth.PASSWORD) {
    sessionStorage.setItem(auth.SESSION_KEY, 'true');
    document.getElementById('loginScreen').style.display = 'none';
    document.getElementById('mainScreen').style.display = 'block';
    initApp();
  } else {
    errorDiv.textContent = 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“';
  }
};

window.logout = function() {
  sessionStorage.removeItem(auth.SESSION_KEY);
  location.reload();
};

if (sessionStorage.getItem(auth.SESSION_KEY) === 'true') {
  document.getElementById('loginScreen').style.display = 'none';
  document.getElementById('mainScreen').style.display = 'block';
  initApp();
}

let currentYear = new Date().getFullYear();
let currentMonth = new Date().getMonth() + 1;
let members = ["ç«¹æœ¬", "æ‘æ¾", "å†¨æ¨«", "ç±³æ‘", "å¤§åŸ", "å¤§æ©‹", "é‡ã€…å£", "å¤§å·", "å¾Œé–‘", "å†…è—¤", "å‰ç”°", "è—¤äº•", "å±±å´"];
let shiftData = {};
let assignedData = {};
let yearlyTotals = {};
let customHolidays = [];

const holidays = {
  '2024-01-01': 'å…ƒæ—¥', '2024-01-08': 'æˆäººã®æ—¥', '2024-02-11': 'å»ºå›½è¨˜å¿µã®æ—¥',
  '2024-02-12': 'æŒ¯æ›¿ä¼‘æ—¥', '2024-02-23': 'å¤©çš‡èª•ç”Ÿæ—¥', '2024-03-20': 'æ˜¥åˆ†ã®æ—¥',
  '2024-04-29': 'æ˜­å’Œã®æ—¥', '2024-05-03': 'æ†²æ³•è¨˜å¿µæ—¥', '2024-05-04': 'ã¿ã©ã‚Šã®æ—¥',
  '2024-05-05': 'ã“ã©ã‚‚ã®æ—¥', '2024-05-06': 'æŒ¯æ›¿ä¼‘æ—¥', '2024-07-15': 'æµ·ã®æ—¥',
  '2024-08-11': 'å±±ã®æ—¥', '2024-08-12': 'æŒ¯æ›¿ä¼‘æ—¥', '2024-09-16': 'æ•¬è€ã®æ—¥',
  '2024-09-22': 'ç§‹åˆ†ã®æ—¥', '2024-09-23': 'æŒ¯æ›¿ä¼‘æ—¥', '2024-10-14': 'ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥',
  '2024-11-03': 'æ–‡åŒ–ã®æ—¥', '2024-11-04': 'æŒ¯æ›¿ä¼‘æ—¥', '2024-11-23': 'å‹¤åŠ´æ„Ÿè¬ã®æ—¥',
  '2025-01-01': 'å…ƒæ—¥', '2025-01-13': 'æˆäººã®æ—¥', '2025-02-11': 'å»ºå›½è¨˜å¿µã®æ—¥',
  '2025-02-23': 'å¤©çš‡èª•ç”Ÿæ—¥', '2025-02-24': 'æŒ¯æ›¿ä¼‘æ—¥', '2025-03-20': 'æ˜¥åˆ†ã®æ—¥',
  '2025-04-29': 'æ˜­å’Œã®æ—¥', '2025-05-03': 'æ†²æ³•è¨˜å¿µæ—¥', '2025-05-04': 'ã¿ã©ã‚Šã®æ—¥',
  '2025-05-05': 'ã“ã©ã‚‚ã®æ—¥', '2025-05-06': 'æŒ¯æ›¿ä¼‘æ—¥', '2025-07-21': 'æµ·ã®æ—¥',
  '2025-08-11': 'å±±ã®æ—¥', '2025-09-15': 'æ•¬è€ã®æ—¥', '2025-09-23': 'ç§‹åˆ†ã®æ—¥',
  '2025-10-13': 'ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥', '2025-11-03': 'æ–‡åŒ–ã®æ—¥', '2025-11-23': 'å‹¤åŠ´æ„Ÿè¬ã®æ—¥',
  '2025-11-24': 'æŒ¯æ›¿ä¼‘æ—¥', '2025-12-23': 'å¤©çš‡èª•ç”Ÿæ—¥', '2026-01-01': 'å…ƒæ—¥', 
  '2026-01-12': 'æˆäººã®æ—¥', '2026-02-11': 'å»ºå›½è¨˜å¿µã®æ—¥', '2026-02-23': 'å¤©çš‡èª•ç”Ÿæ—¥', 
  '2026-03-20': 'æ˜¥åˆ†ã®æ—¥', '2026-04-29': 'æ˜­å’Œã®æ—¥', '2026-05-03': 'æ†²æ³•è¨˜å¿µæ—¥', 
  '2026-05-04': 'ã¿ã©ã‚Šã®æ—¥', '2026-05-05': 'ã“ã©ã‚‚ã®æ—¥', '2026-05-06': 'æŒ¯æ›¿ä¼‘æ—¥', 
  '2026-07-20': 'æµ·ã®æ—¥', '2026-08-11': 'å±±ã®æ—¥', '2026-09-21': 'æ•¬è€ã®æ—¥', 
  '2026-09-22': 'å›½æ°‘ã®ä¼‘æ—¥', '2026-09-23': 'ç§‹åˆ†ã®æ—¥', '2026-10-12': 'ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥', 
  '2026-11-03': 'æ–‡åŒ–ã®æ—¥', '2026-11-23': 'å‹¤åŠ´æ„Ÿè¬ã®æ—¥'
};

async function initApp() {
  await loadData();
  setupRealtimeListeners();
  renderCalendar();
  renderMemberList();
  renderHolidayList();
  updateCountTable();
}

async function loadData() {
  try {
    const snapshot = await get(ref(database, '/'));
    const data = snapshot.val() || {};
    
    if (data.members && data.members.length > 0) {
      members = data.members;
    }
    shiftData = data.shiftData || {};
    assignedData = data.assignedData || {};
    yearlyTotals = data.yearlyTotals || {};
    customHolidays = data.customHolidays || [];

    console.log('ğŸ“¥ ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†', {members: members.length});
  } catch (error) {
    console.error('âŒ ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
  }
}

let saveTimeout = null;
let syncTimeout = null;

async function saveData() {
  // æ—¢å­˜ã®ä¿å­˜ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢
  if (saveTimeout) {
    clearTimeout(saveTimeout);
  }
  
  // åŒæœŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’ã‚¯ãƒªã‚¢
  if (syncTimeout) {
    clearTimeout(syncTimeout);
  }
  
  try {
    updateSyncStatus('syncing');
    
    await set(ref(database, '/'), {
      members,
      shiftData,
      assignedData,
      yearlyTotals,
      customHolidays
    });
    
    updateSyncStatus('success');
    console.log('ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ä¿å­˜å®Œäº†');
    
    // 3ç§’å¾Œã«å¼·åˆ¶çš„ã«ã€ŒåŒæœŸæ¸ˆã¿ã€ã«æˆ»ã™
    syncTimeout = setTimeout(() => {
      updateSyncStatus('success');
    }, 3000);
    
  } catch (error) {
    console.error('âŒ ãƒ‡ãƒ¼ã‚¿ä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
    updateSyncStatus('error');
    
    // ã‚¨ãƒ©ãƒ¼ã§ã‚‚5ç§’å¾Œã«ã€ŒåŒæœŸæ¸ˆã¿ã€ã«æˆ»ã™
    syncTimeout = setTimeout(() => {
      updateSyncStatus('success');
    }, 5000);
  }
}

let updateTimeout = null;

function setupRealtimeListeners() {
  onValue(ref(database, '/'), (snapshot) => {
    // æ—¢å­˜ã®æ›´æ–°ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢
    if (updateTimeout) {
      clearTimeout(updateTimeout);
    }
    
    // 300mså¾Œã«æ›´æ–°ï¼ˆé€£ç¶šã—ãŸæ›´æ–°ã‚’é˜²ãï¼‰
    updateTimeout = setTimeout(() => {
      const data = snapshot.val() || {};
      if (data.members && data.members.length > 0) {
        members = data.members;
      }
      shiftData = data.shiftData || {};
      assignedData = data.assignedData || {};
      yearlyTotals = data.yearlyTotals || {};
      customHolidays = data.customHolidays || [];
      
      renderCalendar();
      renderMemberList();
      renderHolidayList();
      updateCountTable();
      console.log('ğŸ”„ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°');
    }, 300);
  });
}

function updateSyncStatus(status) {
  const statusEl = document.getElementById('syncStatus');
  statusEl.className = 'sync-status';
  
  switch(status) {
    case 'syncing':
      statusEl.textContent = 'âŸ³ åŒæœŸä¸­...';
      statusEl.classList.add('syncing');
      break;
    case 'success':
      statusEl.textContent = 'âœ“ åŒæœŸæ¸ˆã¿';
      break;
    case 'error':
      statusEl.textContent = 'âœ— ã‚¨ãƒ©ãƒ¼';
      statusEl.classList.add('error');
      break;
  }
}

window.addMember = async function() {
  const input = document.getElementById('newMemberName');
  const name = input.value.trim();
  
  if (!name) {
    alert('ãƒ¡ãƒ³ãƒãƒ¼åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
    return;
  }
  
  if (members.includes(name)) {
    alert('ã“ã®ãƒ¡ãƒ³ãƒãƒ¼ã¯æ—¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™');
    return;
  }
  
  members.push(name);
  input.value = '';
  
  if (!yearlyTotals[name]) {
    yearlyTotals[name] = { am: 0, pm: 0 };
  }
  
  await saveData();
};

window.removeMember = async function(name) {
  console.log('ğŸ—‘ï¸ ãƒ¡ãƒ³ãƒãƒ¼å‰Šé™¤é–‹å§‹:', name);
  
  if (!confirm(`${name} ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\nã“ã®ãƒ¡ãƒ³ãƒãƒ¼ã®ã‚·ãƒ•ãƒˆãƒ‡ãƒ¼ã‚¿ã‚‚ã™ã¹ã¦å‰Šé™¤ã•ã‚Œã¾ã™ã€‚`)) {
    console.log('ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ');
    return;
  }
  
  console.log('å‰Šé™¤å‰ã®ãƒ¡ãƒ³ãƒãƒ¼:', members);
  
  members = members.filter(m => m !== name);
  
  console.log('å‰Šé™¤å¾Œã®ãƒ¡ãƒ³ãƒãƒ¼:', members);
  
  // ã‚·ãƒ•ãƒˆãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤
  let deletedShifts = 0;
  Object.keys(shiftData).forEach(key => {
    if (key.includes(`_${name}_`)) {
      delete shiftData[key];
      deletedShifts++;
    }
  });
  
  console.log(`ã‚·ãƒ•ãƒˆãƒ‡ãƒ¼ã‚¿å‰Šé™¤: ${deletedShifts}ä»¶`);
  
  // æ‹…å½“ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤
  let deletedAssignments = 0;
  Object.keys(assignedData).forEach(key => {
    if (assignedData[key] === name) {
      delete assignedData[key];
      deletedAssignments++;
    }
  });
  
  console.log(`æ‹…å½“ãƒ‡ãƒ¼ã‚¿å‰Šé™¤: ${deletedAssignments}ä»¶`);
  
  // ç´¯è¨ˆãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤
  if (yearlyTotals[name]) {
    delete yearlyTotals[name];
    console.log('ç´¯è¨ˆãƒ‡ãƒ¼ã‚¿å‰Šé™¤');
  }
  
  // ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
  await saveData();
  
  // UIã‚’å¼·åˆ¶çš„ã«æ›´æ–°
  renderCalendar();
  renderMemberList();
  updateCountTable();
  
  console.log('âœ… ãƒ¡ãƒ³ãƒãƒ¼å‰Šé™¤å®Œäº†:', name);
  alert(`${name} ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`);
};

window.showDeleteMemberDialog = async function() {
  if (members.length === 0) {
    alert('å‰Šé™¤ã™ã‚‹ãƒ¡ãƒ³ãƒãƒ¼ãŒã„ã¾ã›ã‚“');
    return;
  }
  
  console.log('ç¾åœ¨ã®ãƒ¡ãƒ³ãƒãƒ¼:', members);
  
  const message = 'ãƒ¡ãƒ³ãƒãƒ¼ã‚’é¸æŠã—ã¦ãã ã•ã„:\n\n' + 
    members.map((name, i) => `${i + 1}: ${name}`).join('\n');
  
  const input = prompt(message, '1');
  
  if (input === null) {
    console.log('ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ');
    return;
  }
  
  const index = parseInt(input) - 1;
  
  if (isNaN(index) || index < 0 || index >= members.length) {
    alert('ç„¡åŠ¹ãªç•ªå·ã§ã™');
    console.log('ç„¡åŠ¹ãªç•ªå·:', input);
    return;
  }
  
  const selectedMember = members[index];
  console.log('é¸æŠã•ã‚ŒãŸãƒ¡ãƒ³ãƒãƒ¼:', selectedMember);
  
  await removeMember(selectedMember);
};

function renderMemberList() {
  const listEl = document.getElementById('memberList');
  if (!members || members.length === 0) {
    listEl.innerHTML = '<div style="color: #666; font-size: 12px;">ãƒ¡ãƒ³ãƒãƒ¼ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</div>';
    return;
  }
  
  listEl.innerHTML = '<div style="margin-top: 5px; font-size: 12px; color: #666;">ç™»éŒ²ãƒ¡ãƒ³ãƒãƒ¼ï¼ˆÃ—ã‚’ã‚¯ãƒªãƒƒã‚¯ã§å‰Šé™¤ï¼‰:</div>' + 
    members.map(name => `
    <div class="member-item">
      ${name}
      <button onclick="handleRemoveMember('${name}')" title="å‰Šé™¤">Ã—</button>
    </div>
  `).join('');
}

// Ã—ãƒœã‚¿ãƒ³ç”¨ã®ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
window.handleRemoveMember = async function(name) {
  await removeMember(name);
};

window.addCustomHoliday = async function() {
  const dateInput = document.getElementById('newHolidayDate');
  const date = dateInput.value;
  
  if (!date) {
    alert('æ—¥ä»˜ã‚’é¸æŠã—ã¦ãã ã•ã„');
    return;
  }
  
  if (customHolidays.includes(date)) {
    alert('ã“ã®æ—¥ä»˜ã¯æ—¢ã«ä¼‘æ—¥ã¨ã—ã¦ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™');
    return;
  }
  
  customHolidays.push(date);
  customHolidays.sort();
  
  dateInput.value = '';
  
  await saveData();
};

window.removeCustomHoliday = async function(date) {
  if (!confirm(`${date}ã®ä¼‘æ—¥è¨­å®šã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) return;
  
  customHolidays = customHolidays.filter(h => h !== date);
  
  await saveData();
};

function renderHolidayList() {
  const listEl = document.getElementById('holidayList');
  if (!customHolidays || customHolidays.length === 0) {
    listEl.innerHTML = '<div style="color: #666; font-size: 12px;">è¿½åŠ ã•ã‚ŒãŸä¼‘æ—¥ã¯ã‚ã‚Šã¾ã›ã‚“</div>';
    return;
  }
  
  listEl.innerHTML = customHolidays.map(date => `
    <div class="member-item">
      ${date}
      <button onclick="removeCustomHoliday('${date}')">Ã—</button>
    </div>
  `).join('');
}

window.changeMonth = function(delta) {
  if (delta === 0) {
    const now = new Date();
    currentYear = now.getFullYear();
    currentMonth = now.getMonth() + 1;
  } else {
    currentMonth += delta;
    if (currentMonth > 12) {
      currentMonth = 1;
      currentYear++;
    } else if (currentMonth < 1) {
      currentMonth = 12;
      currentYear--;
    }
  }
  renderCalendar();
  updateCountTable();
};

function renderCalendar() {
  document.getElementById('currentMonth').textContent = `${currentYear}å¹´${currentMonth}æœˆ`;
  
  const headerRow = document.getElementById('headerRow');
  headerRow.innerHTML = '<th>æ—¥ä»˜</th><th>æ™‚é–“</th><th>æ‹…å½“</th>';
  members.forEach(name => {
    headerRow.innerHTML += `<th>${name}</th>`;
  });
  
  const tbody = document.getElementById('calendarBody');
  tbody.innerHTML = '';
  
  const daysInMonth = new Date(currentYear, currentMonth, 0).getDate();
  
  for (let day = 1; day <= daysInMonth; day++) {
    const date = new Date(currentYear, currentMonth - 1, day);
    const dayOfWeek = date.getDay();
    const dateStr = `${currentYear}-${String(currentMonth).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
    const weekDayNames = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
    
    const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
    const isHoliday = holidays[dateStr] || customHolidays.includes(dateStr);
    const bgClass = (isWeekend || isHoliday) ? 'weekend-bg' : '';
    
    // AMè¡Œ
    const amRow = document.createElement('tr');
    
    // æ—¥ä»˜ã‚»ãƒ«
    const dateCell = document.createElement('td');
    dateCell.className = bgClass;
    dateCell.rowSpan = 2;
    dateCell.style.fontSize = '11px';
    dateCell.style.lineHeight = '1.2';
    dateCell.innerHTML = `${day}<br>(${weekDayNames[dayOfWeek]})`;
    amRow.appendChild(dateCell);
    
    // AMæ™‚é–“ã‚»ãƒ«
    const amTimeCell = document.createElement('td');
    amTimeCell.className = bgClass;
    amTimeCell.textContent = 'AM';
    amRow.appendChild(amTimeCell);
    
    // AMæ‹…å½“ã‚»ãƒ«
    const amAssignCell = document.createElement('td');
    amAssignCell.className = `assigned-cell ${bgClass}`;
    const amSelect = document.createElement('select');
    amSelect.innerHTML = '<option value="">-</option>' + members.map(m => 
      `<option value="${m}" ${assignedData[dateStr + '_am'] === m ? 'selected' : ''}>${m}</option>`
    ).join('');
    amSelect.addEventListener('change', async function() {
      await updateAssigned(dateStr, 'am', this.value);
    });
    amAssignCell.appendChild(amSelect);
    amRow.appendChild(amAssignCell);
    
    // AMã‚·ãƒ•ãƒˆå¸Œæœ›ã‚»ãƒ«
    members.forEach(name => {
      const key = `${dateStr}_${name}_am`;
      const value = shiftData[key] || '';
      const cellClass = value === 'â—' ? 'best' : value === 'â—‹' ? 'good' : value === 'Ã—' ? 'bad' : '';
      
      const td = document.createElement('td');
      td.className = `shift-cell ${cellClass} ${bgClass}`;
      td.textContent = value || '-';
      
      // â—ã®å ´åˆã ã‘ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å¤§ããã™ã‚‹
      if (value === 'â—') {
        td.style.fontSize = '18px';
      }
      
      td.setAttribute('data-date', dateStr);
      td.setAttribute('data-name', name);
      td.setAttribute('data-period', 'am');
      td.onclick = function() {
        toggleShift(dateStr, name, 'am');
      };
      amRow.appendChild(td);
    });
    
    // PMè¡Œ
    const pmRow = document.createElement('tr');
    
    // PMæ™‚é–“ã‚»ãƒ«
    const pmTimeCell = document.createElement('td');
    pmTimeCell.className = bgClass;
    pmTimeCell.textContent = 'PM';
    pmRow.appendChild(pmTimeCell);
    
    // PMæ‹…å½“ã‚»ãƒ«
    const pmAssignCell = document.createElement('td');
    pmAssignCell.className = `assigned-cell ${bgClass}`;
    const pmSelect = document.createElement('select');
    pmSelect.innerHTML = '<option value="">-</option>' + members.map(m => 
      `<option value="${m}" ${assignedData[dateStr + '_pm'] === m ? 'selected' : ''}>${m}</option>`
    ).join('');
    pmSelect.addEventListener('change', async function() {
      await updateAssigned(dateStr, 'pm', this.value);
    });
    pmAssignCell.appendChild(pmSelect);
    pmRow.appendChild(pmAssignCell);
    
    // PMã‚·ãƒ•ãƒˆå¸Œæœ›ã‚»ãƒ«
    members.forEach(name => {
      const key = `${dateStr}_${name}_pm`;
      const value = shiftData[key] || '';
      const cellClass = value === 'â—' ? 'best' : value === 'â—‹' ? 'good' : value === 'Ã—' ? 'bad' : '';
      
      const td = document.createElement('td');
      td.className = `shift-cell ${cellClass} ${bgClass}`;
      td.textContent = value || '-';
      
      // â—ã®å ´åˆã ã‘ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å¤§ããã™ã‚‹
      if (value === 'â—') {
        td.style.fontSize = '18px';
      }
      
      td.setAttribute('data-date', dateStr);
      td.setAttribute('data-name', name);
      td.setAttribute('data-period', 'pm');
      td.onclick = function() {
        toggleShift(dateStr, name, 'pm');
      };
      pmRow.appendChild(td);
    });
    
    tbody.appendChild(amRow);
    tbody.appendChild(pmRow);
  }
  
  console.log('âœ… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æç”»å®Œäº†');
}

let toggleTimeout = null;

async function toggleShift(date, member, period) {
  // é€£ç¶šã‚¯ãƒªãƒƒã‚¯ã‚’é˜²ã
  if (toggleTimeout) {
    clearTimeout(toggleTimeout);
  }
  
  const key = `${date}_${member}_${period}`;
  const current = shiftData[key] || '';
  
  const nextValue = current === '' ? 'â—' : current === 'â—' ? 'â—‹' : current === 'â—‹' ? 'Ã—' : '';
  
  if (nextValue === '') {
    delete shiftData[key];
  } else {
    shiftData[key] = nextValue;
  }
  
  console.log(`ã‚·ãƒ•ãƒˆæ›´æ–°: ${date} ${member} ${period} â†’ ${nextValue || 'ç©ºç™½'}`);
  
  // å³åº§ã«UIã‚’æ›´æ–°
  renderCalendar();
  
  // 500mså¾Œã«ä¿å­˜
  toggleTimeout = setTimeout(async () => {
    await saveData();
  }, 500);
}

async function updateAssigned(date, period, newAssigned) {
  const key = `${date}_${period}`;
  const oldAssigned = assignedData[key];
  
  if (oldAssigned && yearlyTotals[oldAssigned]) {
    yearlyTotals[oldAssigned][period] = Math.max(0, yearlyTotals[oldAssigned][period] - 1);
  }
  
  if (newAssigned) {
    assignedData[key] = newAssigned;
    if (!yearlyTotals[newAssigned]) {
      yearlyTotals[newAssigned] = { am: 0, pm: 0 };
    }
    yearlyTotals[newAssigned][period]++;
  } else {
    delete assignedData[key];
  }
  
  await saveData();
  updateCountTable();
}

window.autoAssign = async function() {
  if (!confirm('ä»Šæœˆã®æœªå‰²å½“æ—¥ã‚’è‡ªå‹•çš„ã«å‰²ã‚ŠæŒ¯ã‚Šã¾ã™ã‹ï¼Ÿ\nâ€»åœŸæ—¥ãƒ»ç¥æ—¥ã¯ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™')) return;
  
  console.log('ğŸ¯ è‡ªå‹•å‰²ã‚ŠæŒ¯ã‚Šé–‹å§‹');
  console.log(`å¯¾è±¡æœˆ: ${currentYear}å¹´${currentMonth}æœˆ`);
  console.log(`ãƒ¡ãƒ³ãƒãƒ¼æ•°: ${members.length}`);
  
  const daysInMonth = new Date(currentYear, currentMonth, 0).getDate();
  let assigned = 0;
  let skipped = 0;
  
  for (let day = 1; day <= daysInMonth; day++) {
    const dateStr = `${currentYear}-${String(currentMonth).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
    const date = new Date(currentYear, currentMonth - 1, day);
    const dayOfWeek = date.getDay();
    
    // åœŸæ—¥ãƒ»ç¥æ—¥ã‚’ã‚¹ã‚­ãƒƒãƒ—
    const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
    const isHoliday = holidays[dateStr] || customHolidays.includes(dateStr);
    
    if (isWeekend || isHoliday) {
      console.log(`${dateStr}: åœŸæ—¥ç¥æ—¥ã®ãŸã‚ã‚¹ã‚­ãƒƒãƒ—`);
      skipped++;
      continue;
    }
    
    // AM
    if (!assignedData[dateStr + '_am']) {
      const member = selectBestMember(dateStr, 'am');
      console.log(`${dateStr} AM: ${member}ã‚’é¸æŠ`);
      if (member) {
        assignedData[dateStr + '_am'] = member;
        if (!yearlyTotals[member]) yearlyTotals[member] = { am: 0, pm: 0 };
        yearlyTotals[member].am++;
        assigned++;
      }
    }
    
    // PM
    if (!assignedData[dateStr + '_pm']) {
      const member = selectBestMember(dateStr, 'pm');
      console.log(`${dateStr} PM: ${member}ã‚’é¸æŠ`);
      if (member) {
        assignedData[dateStr + '_pm'] = member;
        if (!yearlyTotals[member]) yearlyTotals[member] = { am: 0, pm: 0 };
        yearlyTotals[member].pm++;
        assigned++;
      }
    }
  }
  
  console.log(`âœ… è‡ªå‹•å‰²ã‚ŠæŒ¯ã‚Šå®Œäº†: ${assigned}ä»¶ (${skipped}æ—¥ã‚¹ã‚­ãƒƒãƒ—)`);
  
  await saveData();
  renderCalendar();
  updateCountTable();
  alert(`${assigned}ä»¶ã®ã‚·ãƒ•ãƒˆã‚’è‡ªå‹•å‰²ã‚ŠæŒ¯ã‚Šã—ã¾ã—ãŸ\nï¼ˆåœŸæ—¥ç¥æ—¥${skipped}æ—¥ã¯ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸï¼‰`);
};

function selectBestMember(date, period) {
  if (members.length === 0) {
    console.log('âŒ ãƒ¡ãƒ³ãƒãƒ¼ãŒ0äºº');
    return null;
  }
  
  const candidates = members.map(name => {
    const key = `${date}_${name}_${period}`;
    const preference = shiftData[key] || '';
    const totals = yearlyTotals[name] || { am: 0, pm: 0 };
    
    let priority = 0;
    if (preference === 'â—') priority = 3;
    else if (preference === 'â—‹') priority = 2;
    else if (preference === '') priority = 1;
    else if (preference === 'Ã—') priority = 0;
    
    return {
      name,
      priority,
      preference,
      amTotal: totals.am,
      pmTotal: totals.pm,
      total: totals.am + totals.pm
    };
  });
  
  console.log(`${date} ${period} ã®å€™è£œ:`, candidates);
  
  const groups = {
    3: candidates.filter(c => c.priority === 3),
    2: candidates.filter(c => c.priority === 2),
    1: candidates.filter(c => c.priority === 1),
    0: candidates.filter(c => c.priority === 0)
  };
  
  for (let p = 3; p >= 0; p--) {
    if (groups[p].length > 0) {
      groups[p].sort((a, b) => {
        const aCount = period === 'am' ? a.amTotal : a.pmTotal;
        const bCount = period === 'am' ? b.amTotal : b.pmTotal;
        if (aCount !== bCount) return aCount - bCount;
        return a.total - b.total;
      });
      console.log(`  å„ªå…ˆåº¦${p}ã‚°ãƒ«ãƒ¼ãƒ—ã‹ã‚‰é¸æŠ: ${groups[p][0].name}`);
      return groups[p][0].name;
    }
  }
  
  console.log('  é¸æŠå¯èƒ½ãªãƒ¡ãƒ³ãƒãƒ¼ãªã—');
  return null;
}

function updateCountTable() {
  const tbody = document.getElementById('countTableBody');
  if (!tbody) {
    console.error('âŒ countTableBodyãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
    return;
  }
  
  console.log('ğŸ“Š ã‚«ã‚¦ãƒ³ãƒˆè¡¨ã‚’æ›´æ–°', {
    ãƒ¡ãƒ³ãƒãƒ¼æ•°: members.length,
    å¹´æœˆ: `${currentYear}å¹´${currentMonth}æœˆ`
  });
  
  tbody.innerHTML = '';
  
  if (members.length === 0) {
    console.warn('âš ï¸ ãƒ¡ãƒ³ãƒãƒ¼ãŒ0äººã§ã™');
    return;
  }
  
  // ä»Šæœˆã®ã‚«ã‚¦ãƒ³ãƒˆã‚’è¨ˆç®—
  const monthlyCount = {};
  members.forEach(name => {
    monthlyCount[name] = { am: 0, pm: 0 };
  });
  
  const daysInMonth = new Date(currentYear, currentMonth, 0).getDate();
  for (let day = 1; day <= daysInMonth; day++) {
    const dateStr = `${currentYear}-${String(currentMonth).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
    
    const amAssigned = assignedData[dateStr + '_am'];
    const pmAssigned = assignedData[dateStr + '_pm'];
    
    if (amAssigned && monthlyCount[amAssigned]) {
      monthlyCount[amAssigned].am++;
    }
    if (pmAssigned && monthlyCount[pmAssigned]) {
      monthlyCount[pmAssigned].pm++;
    }
  }
  
  // ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¡¨ç¤º
  members.forEach(name => {
    const monthly = monthlyCount[name] || { am: 0, pm: 0 };
    const yearly = yearlyTotals[name] || { am: 0, pm: 0 };
    
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td style="font-weight: bold;">${name}</td>
      <td style="background: #e3f2fd;">${monthly.am}</td>
      <td style="background: #e3f2fd;">${monthly.pm}</td>
      <td style="background: #bbdefb; font-weight: bold;">${monthly.am + monthly.pm}</td>
      <td>${yearly.am}</td>
      <td>${yearly.pm}</td>
      <td style="font-weight: bold;">${yearly.am + yearly.pm}</td>
    `;
    tbody.appendChild(tr);
  });
  
  console.log('âœ… ã‚«ã‚¦ãƒ³ãƒˆè¡¨æ›´æ–°å®Œäº†');
}

// å¾Œæ–¹äº’æ›æ€§ã®ãŸã‚ã€å¤ã„é–¢æ•°ã‚‚æ®‹ã™
function updateTotalsDisplay() {
  updateCountTable();
}

function updateMonthlyCount() {
  updateCountTable();
}

window.resetData = async function() {
  if (!confirm('ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) return;
  
  const confirmText = prompt('æœ¬å½“ã«å‰Šé™¤ã™ã‚‹å ´åˆã¯ã€Œå‰Šé™¤ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„');
  if (confirmText !== 'å‰Šé™¤') return;
  
  members = ["ç«¹æœ¬", "æ‘æ¾", "å†¨æ¨«", "ç±³æ‘", "å¤§åŸ", "å¤§æ©‹", "é‡ã€…å£", "å¤§å·", "å¾Œé–‘", "å†…è—¤", "å‰ç”°", "è—¤äº•", "å±±å´"];
  shiftData = {};
  assignedData = {};
  yearlyTotals = {};
  customHolidays = [];
  
  await saveData();
  alert('ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
};

</script>

</body>
</html>
